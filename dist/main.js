(()=>{"use strict";const r=function(r){for(var e,n=[],s=1;s<arguments.length;s++)n[s-1]=arguments[s];this.squares=[];var u=n.map((function(e){return{color:r,x:e.x,y:e.y}}));(e=this.squares).push.apply(e,u)};var e=document.querySelector("#canvas"),n=e.getContext("2d"),s=50,u=800,a=500,t=-s,o=s,c=!1,y=300,i=new r(""),f=new r("");e.height=u+4,e.width=a+4;var l=0,x=!1;function q(){switch(Math.floor(7*Math.random())){case 0:f=new r("cyan",{x:o,y:t},{x:o+50,y:t},{x:o+100,y:t},{x:o+150,y:t});break;case 1:f=new r("blue",{x:o,y:t},{x:o+50,y:t},{x:o+100,y:t},{x:o+100,y:t+50});break;case 2:f=new r("orange",{x:o,y:t},{x:o+50,y:t},{x:o+100,y:t},{x:o+100,y:t-50});break;case 3:f=new r("yellow",{x:o,y:t},{x:o+50,y:t},{x:o,y:t+50},{x:o+50,y:t+50});break;case 4:f=new r("red",{x:o,y:t},{x:o+50,y:t},{x:o+50,y:t+50},{x:o+100,y:t+50}),"red",f.squares.forEach((function(r){r.color="red"}));break;case 5:f=new r("green",{x:o,y:t},{x:o+50,y:t},{x:o+50,y:t-50},{x:o+100,y:t-50});break;default:f=new r("violet",{x:o,y:t},{x:o+50,y:t},{x:o+50,y:t-50},{x:o+100,y:t})}}function h(r,e){return r<0||r+s>a||e+s>u||i.squares.find((function(n){return n.x==r&&n.y==e}))}function d(){var r,e,n,t;f.squares.find((function(r){return r.y>=u-s}))||f.squares.find((function(r){return h(r.x,r.y+s)}))?((r=i.squares).push.apply(r,f.squares),e=[],n=[],i.squares.forEach((function(r){var u=e.find((function(e){return e.y==r.y}));u?++u.count>=a/s&&n.push(u.y):e.push({y:r.y,count:1})})),(t=n).sort(),t.forEach((function(r){var e;e=r,i.squares=i.squares.filter((function(r){return r.y!==e}))})),t.forEach((function(r){var e;e=r,i.squares.forEach((function(r){r.y<e&&(r.y+=s)}))})),t.length&&function(r){l+=r;var e=document.querySelector("#rowScore");e&&(e.innerHTML=l.toString()),console.log("test"),y=300*Math.pow(.9,l);var n=document.querySelector("#speed");n&&(n.innerHTML=(Math.round(1/y*1e5)/100).toString())}(t.length),q()):f.squares.forEach((function(r){r.y+=s}))}q(),function r(){setTimeout((function(){if(x=!0,d(),i.squares.find((function(r){return r.y<0}))){var e=document.querySelector("#lostLabel");e&&(e.style.display="block"),c=!0}else r()}),y)}(),function r(){requestAnimationFrame((function(){x&&(function(){if(n){n.clearRect(0,0,e.width,e.height);for(var r=0;r<i.squares.length;r++)n.beginPath(),n.lineWidth=4,n.strokeStyle="black",n.fillStyle=i.squares[r].color,n.rect(i.squares[r].x+2,i.squares[r].y+2,s,s),n.fill(),n.stroke();for(r=0;r<f.squares.length;r++)n.beginPath(),n.lineWidth=4,n.strokeStyle="black",n.fillStyle=f.squares[r].color,n.rect(f.squares[r].x+2,f.squares[r].y+2,s,s),n.fill(),n.stroke()}}(),x=!1),c||r()}))}(),document.onkeydown=function(e){38==e.keyCode?(function(){if("yellow"!=f.squares[0].color&&!c){JSON.parse(JSON.stringify(f));var e=new r(f.squares[0].color);e.squares=f.squares.map((function(r){return{x:r.x-f.squares[1].x,y:r.y-f.squares[1].y,color:r.color}}));var n=new r(f.squares[0].color);n.squares=function(r){return r.squares.map((function(r){var e=r.x;return{x:r.x=-r.y+f.squares[1].x,y:r.y=e+f.squares[1].y,color:r.color}}))}(e);var u=new r(f.squares[0].color);u.squares=n.squares.filter((function(r){return h(r.x,r.y)})),u&&(n=function(r,e,n){var u=Math.min.apply(Math,r.squares.map((function(r){return r.x}))),a=Math.max.apply(Math,r.squares.map((function(r){return r.x}))),t=Math.max.apply(Math,r.squares.map((function(r){return r.y}))),o=n;if(u<e.squares[1].x&&a>e.squares[1].x);else if(u<n.squares[1].x){var c=n.squares[1].x-u;o.squares=n.squares.map((function(r){return{x:r.x+=c,y:r.y,color:r.color}}))}else if(a>n.squares[1].x){var y=n.squares[1].x-a;o.squares=n.squares.map((function(r){return{x:r.x+=y,y:r.y,color:r.color}}))}else if(t>=n.squares[1].y){var i=t-n.squares[1].y+s;o.squares=n.squares.map((function(r){return{x:r.x,y:r.y-=i,color:r.color}}))}return o}(u,e,n)),n.squares.find((function(r){return h(r.x,r.y)}))||(f=n)}}(),x=!0):40==e.keyCode?(d(),x=!0):37==e.keyCode?(f.squares.find((function(r){return h(r.x-s,r.y)}))||f.squares.forEach((function(r){r.x-=s})),x=!0):39==e.keyCode&&(f.squares.find((function(r){return h(r.x+s,r.y)}))||f.squares.forEach((function(r){r.x+=s})),x=!0)}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QXBDLEtBYnZDYyxFQUFjbkIsUUFBUTRCLFNBQVEsU0FBQ0MsR0FBT0EsRUFBRXpCLEdBQUtTLENBQVUsSUFzSHZEVSxHQUFlLEVBR3ZCLEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90ZXRyaXMvLi9zcmMvQmxvY2sudHMiLCJ3ZWJwYWNrOi8vdGV0cmlzLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIiBleHBvcnQgZGVmYXVsdCBjbGFzcyBCbG9jayB7XG4gICAgc3F1YXJlczogU3F1YXJlW10gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKGNvbG9yOiBzdHJpbmcsIC4uLnNxdWFyZUNvb3JkaW5hdGU6IHt4OiBudW1iZXIsIHk6IG51bWJlcn1bXSApIHtcbiAgICAgICAgICAgIGNvbnN0IHNxdWFyZXMgPSBzcXVhcmVDb29yZGluYXRlLm1hcCgoY29vcmRpbmF0ZSkgPT4gKHtjb2xvcjogY29sb3IsIHg6IGNvb3JkaW5hdGUueCwgeTogY29vcmRpbmF0ZS55fSkpO1xuICAgICAgICAgICAgdGhpcy5zcXVhcmVzLnB1c2goLi4uc3F1YXJlcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IEJsb2NrIGZyb20gJy4vQmxvY2snO1xuXG5jb25zdCBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhbnZhc1wiKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcbmNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuY29uc3QgU1RPTkVfU0laRSA9IDUwO1xuY29uc3QgQ0FOVkFTX0hFSUdIVCA9IDgwMDtcbmNvbnN0IENBTlZBU19XSURUSCA9IDUwMDtcbmNvbnN0IGxJTkVfV0lEVEggPSA0O1xudmFyIHkgPSAtU1RPTkVfU0laRVxudmFyIHggPSBTVE9ORV9TSVpFXG52YXIgZ2FtZU92ZXIgPSBmYWxzZTtcbmxldCBpbnRlcmZhbGxUaW1lciA9IDMwMDtcblxubGV0IHN0b25lczogQmxvY2sgPSBuZXcgQmxvY2soJycpO1xubGV0IGRyb3BwaW5nU3RvbmU6IEJsb2NrID0gbmV3IEJsb2NrKCcnKTtcbmNhbnZhcy5oZWlnaHQgPSBDQU5WQVNfSEVJR0hUICsgbElORV9XSURUSDtcbmNhbnZhcy53aWR0aCA9IENBTlZBU19XSURUSCArIGxJTkVfV0lEVEg7XG52YXIgcm93U2NvcmUgPSAwO1xubGV0IHJlRHJhd05lZWRlZCA9IGZhbHNlO1xuXG5mdW5jdGlvbiBpbmNyZWFzZVJvd1Njb3JlKGFkZFJvd3NDb3VudDogbnVtYmVyKSB7XG4gICAgcm93U2NvcmUgKz0gYWRkUm93c0NvdW50O1xuICAgIGNvbnN0IHJvd1Njb3JlTGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcm93U2NvcmUnKTtcbiAgICBpZihyb3dTY29yZUxhYmVsKSB7XG4gICAgICAgIHJvd1Njb3JlTGFiZWwuaW5uZXJIVE1MID0gcm93U2NvcmUudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJ3Rlc3QnKTtcbiAgICBpbnRlcmZhbGxUaW1lciA9IDMwMCAqIE1hdGgucG93KDAuOSwgcm93U2NvcmUpO1xuICAgIGNvbnN0IGludGVydmFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NwZWVkJyk7XG4gICAgaWYoaW50ZXJ2YWwpIHtcbiAgICAgICAgaW50ZXJ2YWwuaW5uZXJIVE1MID0gKE1hdGgucm91bmQoMSAvIGludGVyZmFsbFRpbWVyICogMTAwMDAwKSAvIDEwMCkudG9TdHJpbmcoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNhbGN1bGF0ZVJvdGF0ZWREcm9wcGluZ1N0b25lKHJlbGF0aXZlUG9zOiBCbG9jaykge1xuICAgIHJldHVybiByZWxhdGl2ZVBvcy5zcXVhcmVzLm1hcCgocykgPT4geyBcbiAgICAgICAgbGV0IHggPSBzLng7IFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogcy54ID0gLXMueSArIGRyb3BwaW5nU3RvbmUuc3F1YXJlc1sxXS54LCBcbiAgICAgICAgICAgIHk6IHMueSA9IHggKyBkcm9wcGluZ1N0b25lLnNxdWFyZXNbMV0ueSxcbiAgICAgICAgICAgIGNvbG9yOiBzLmNvbG9yXG4gICAgICAgIH07XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHN1Z2dlc3RQb3NpdGlvbkNvcnJlY3Rpb24odGFrZW5Qb3NpdGlvbjogQmxvY2ssIHJlbGF0aXZlUG9zOiBCbG9jaywgbmV3UG9zaXRpb25zOiBCbG9jaykge1xuICAgIGNvbnN0IG1pblggPSBNYXRoLm1pbiguLi50YWtlblBvc2l0aW9uLnNxdWFyZXMubWFwKHBvc2l0aW9uID0+IHBvc2l0aW9uLngpKTtcbiAgICBjb25zdCBtYXhYID0gTWF0aC5tYXgoLi4udGFrZW5Qb3NpdGlvbi5zcXVhcmVzLm1hcChwb3NpdGlvbiA9PiBwb3NpdGlvbi54KSk7XG4gICAgY29uc3QgbWF4WSA9IE1hdGgubWF4KC4uLnRha2VuUG9zaXRpb24uc3F1YXJlcy5tYXAocG9zaXRpb24gPT4gcG9zaXRpb24ueSkpO1xuICAgIGxldCBjb3JyZWN0aW9uID0gbmV3UG9zaXRpb25zOyAgXG4gICAgaWYobWluWCA8IHJlbGF0aXZlUG9zLnNxdWFyZXNbMV0ueCAmJiBtYXhYID4gcmVsYXRpdmVQb3Muc3F1YXJlc1sxXS54KSB7XG4gICAgICAgLy8gY2Fubm90IGNvcnJlY3QgcG9zaXRpb25cbiAgICB9IGVsc2UgaWYgKG1pblggPCBuZXdQb3NpdGlvbnMuc3F1YXJlc1sxXS54KXtcbiAgICAgICAgY29uc3QgbW92ZURpc3RhbmNlID0gbmV3UG9zaXRpb25zLnNxdWFyZXNbMV0ueCAtIG1pblg7XG4gICAgICAgIGNvcnJlY3Rpb24uc3F1YXJlcyA9IG5ld1Bvc2l0aW9ucy5zcXVhcmVzLm1hcCgoc3RvbmUpID0+ICh7eDogc3RvbmUueCArPSBtb3ZlRGlzdGFuY2UsIHk6IHN0b25lLnksIGNvbG9yOiBzdG9uZS5jb2xvcn0pKTtcbiAgICB9IGVsc2UgaWYgKG1heFggPiBuZXdQb3NpdGlvbnMuc3F1YXJlc1sxXS54KSB7XG4gICAgICAgIGNvbnN0IG1vdmVEaXN0YW5jZSA9IG5ld1Bvc2l0aW9ucy5zcXVhcmVzWzFdLnggLSBtYXhYO1xuICAgICAgICBjb3JyZWN0aW9uLnNxdWFyZXMgPSBuZXdQb3NpdGlvbnMuc3F1YXJlcy5tYXAoKHN0b25lKSA9PiAoe3g6IHN0b25lLnggKz0gbW92ZURpc3RhbmNlLCB5OiBzdG9uZS55LCBjb2xvcjogc3RvbmUuY29sb3J9KSk7XG4gICAgfSBlbHNlIGlmIChtYXhZID49IG5ld1Bvc2l0aW9ucy5zcXVhcmVzWzFdLnkpIHtcbiAgICAgICAgY29uc3QgbW92ZURpc3RhbmNlID0gbWF4WSAtIG5ld1Bvc2l0aW9ucy5zcXVhcmVzWzFdLnkgKyBTVE9ORV9TSVpFO1xuICAgICAgICBjb3JyZWN0aW9uLnNxdWFyZXMgPSBuZXdQb3NpdGlvbnMuc3F1YXJlcy5tYXAoKHN0b25lKSA9PiAoe3g6IHN0b25lLngsIHk6IHN0b25lLnkgLT0gbW92ZURpc3RhbmNlLCBjb2xvcjogc3RvbmUuY29sb3J9KSk7XG4gICAgfVxuICAgIHJldHVybiBjb3JyZWN0aW9uO1xufVxuXG5mdW5jdGlvbiB0cnlSb3RhdGVTdG9uZSgpIHtcbiAgICBpZihkcm9wcGluZ1N0b25lLnNxdWFyZXNbMF0uY29sb3IgIT0gJ3llbGxvdycgJiYgIWdhbWVPdmVyKSB7XG4gICAgICAgIGNvbnN0IG9yaWdpbmFsUG9zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkcm9wcGluZ1N0b25lKSk7XG4gICAgICAgIGNvbnN0IHJlbGF0aXZlUG9zID0gbmV3IEJsb2NrKGRyb3BwaW5nU3RvbmUuc3F1YXJlc1swXS5jb2xvcik7XG4gICAgICAgIHJlbGF0aXZlUG9zLnNxdWFyZXMgPSBkcm9wcGluZ1N0b25lLnNxdWFyZXMubWFwKChzKSA9PiAoe3g6IChzLnggLSBkcm9wcGluZ1N0b25lLnNxdWFyZXNbMV0ueCksIHk6IHMueSAtIGRyb3BwaW5nU3RvbmUuc3F1YXJlc1sxXS55LCBjb2xvcjogcy5jb2xvcn0pKTtcbiAgICAgICAgbGV0IG5ld1Bvc2l0aW9ucyA9IG5ldyBCbG9jayhkcm9wcGluZ1N0b25lLnNxdWFyZXNbMF0uY29sb3IpO1xuICAgICAgICBuZXdQb3NpdGlvbnMuc3F1YXJlcyA9IGNhbGN1bGF0ZVJvdGF0ZWREcm9wcGluZ1N0b25lKHJlbGF0aXZlUG9zKTtcbiAgICAgICAgY29uc3QgdGFrZW5Qb3NpdGlvbiA9IG5ldyBCbG9jayhkcm9wcGluZ1N0b25lLnNxdWFyZXNbMF0uY29sb3IpO1xuICAgICAgICB0YWtlblBvc2l0aW9uLnNxdWFyZXMgPSBuZXdQb3NpdGlvbnMuc3F1YXJlcy5maWx0ZXIoKHN0b25lKSA9PiBpc1Bvc2l0aW9uVGFrZW4oc3RvbmUueCwgc3RvbmUueSkpO1xuICAgICAgICBpZih0YWtlblBvc2l0aW9uKSB7XG4gICAgICAgICAgICBuZXdQb3NpdGlvbnMgPSBzdWdnZXN0UG9zaXRpb25Db3JyZWN0aW9uKHRha2VuUG9zaXRpb24sIHJlbGF0aXZlUG9zLCBuZXdQb3NpdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIGlmKCFuZXdQb3NpdGlvbnMuc3F1YXJlcy5maW5kKChzdG9uZSkgPT4gaXNQb3NpdGlvblRha2VuKHN0b25lLngsIHN0b25lLnkpKSkge1xuICAgICAgICAgICAgZHJvcHBpbmdTdG9uZSA9IG5ld1Bvc2l0aW9ucztcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gc2V0RHJvcHBpbmdTdG9uZUNvbG9yKGNvbG9yOiBzdHJpbmcpIHtcbiAgICBkcm9wcGluZ1N0b25lLnNxdWFyZXMuZm9yRWFjaCgocykgPT4ge3MuY29sb3IgPSBjb2xvcn0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVOZXdTdG9uZSgpIHtcbiAgICBjb25zdCByYW5kb21OciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDcpO1xuICAgIHN3aXRjaChyYW5kb21Ocikge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBkcm9wcGluZ1N0b25lID0gbmV3IEJsb2NrKCdjeWFuJywge3gsIHl9LCB7eDogeCArIDUwLHl9LCB7eDogeCArIDEwMCx5fSwge3g6IHggKyAxNTAseX0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgIGRyb3BwaW5nU3RvbmUgPSBuZXcgQmxvY2soJ2JsdWUnLCB7eCwgeX0sIHt4OiB4ICsgNTAseX0sIHt4OiB4ICsgMTAwLHl9LCB7eDogeCArIDEwMCx5OiB5ICsgNTB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBkcm9wcGluZ1N0b25lID0gbmV3IEJsb2NrKCdvcmFuZ2UnLCB7eCwgeX0sIHt4OiB4ICsgNTAseX0sIHt4OiB4ICsgMTAwLHl9LCB7eDogeCArIDEwMCx5OiB5IC0gNTB9KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBkcm9wcGluZ1N0b25lID0gbmV3IEJsb2NrKCd5ZWxsb3cnLCB7eCwgeX0sIHt4OiB4ICsgNTAseX0sIHt4LHk6IHkgKyA1MH0sIHt4OiB4ICsgNTAseTogeSArIDUwfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgZHJvcHBpbmdTdG9uZSA9IG5ldyBCbG9jaygncmVkJywge3gsIHl9LCB7eDogeCArIDUwLHl9LCB7eDogeCArIDUwLHk6IHkgKyA1MH0sIHt4OiB4ICsgMTAwLHk6IHkgKyA1MH0pO1xuICAgICAgICAgICAgc2V0RHJvcHBpbmdTdG9uZUNvbG9yKCdyZWQnKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIGRyb3BwaW5nU3RvbmUgPSBuZXcgQmxvY2soJ2dyZWVuJywge3gsIHl9LCB7eDogeCArIDUwLHl9LCB7eDogeCArIDUwLHk6IHkgLSA1MH0sIHt4OiB4ICsgMTAwLHk6IHkgLSA1MH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBkcm9wcGluZ1N0b25lID0gbmV3IEJsb2NrKCd2aW9sZXQnLCB7eCwgeX0sIHt4OiB4ICsgNTAseX0sIHt4OiB4ICsgNTAseTogeSAtIDUwfSwge3g6IHggKyAxMDAseTogeX0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0RmluaXNoZWRSb3dzKCkge1xuICAgIGNvbnN0IGNvbGxlY3RlZFJvd3M6IHsgeTogbnVtYmVyLCBjb3VudDogbnVtYmVyfVtdID0gW11cbiAgICBjb25zdCBmaW5pc2hlZFJvd3M6IG51bWJlcltdID0gW107XG4gICAgc3RvbmVzLnNxdWFyZXMuZm9yRWFjaCgoc3RvbmUpID0+IHtcbiAgICAgICAgbGV0IHJvdyA9IGNvbGxlY3RlZFJvd3MuZmluZCgocm93KSA9PiByb3cueSA9PSBzdG9uZS55KVxuICAgICAgICBpZiAoIXJvdykge1xuICAgICAgICAgICAgY29sbGVjdGVkUm93cy5wdXNoKHt5OiBzdG9uZS55LCBjb3VudDogMX0pO1xuICAgICAgICB9IGVsc2UgaWYgKCsrcm93LmNvdW50ID49IENBTlZBU19XSURUSCAvIFNUT05FX1NJWkUpIHtcbiAgICAgICAgICAgIGZpbmlzaGVkUm93cy5wdXNoKHJvdy55KTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBmaW5pc2hlZFJvd3M7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVN0b25lc1dpdGhZQ29vcmRpbmF0ZSh5Q29vcmRpbmF0ZTogbnVtYmVyKSB7XG4gICAgc3RvbmVzLnNxdWFyZXMgPSBzdG9uZXMuc3F1YXJlcy5maWx0ZXIoKHMpID0+IHMueSAhPT0geUNvb3JkaW5hdGUpO1xufVxuXG5mdW5jdGlvbiBtb3ZlU3RvbmVzRG93bndhcmRzV2l0aFlDb29yZGluYXRlKHlDb29yZGluYXRlOiBudW1iZXIpIHtcbiAgICBzdG9uZXMuc3F1YXJlcy5mb3JFYWNoKChzdG9uZSkgPT4ge1xuICAgICAgICBpZihzdG9uZS55IDwgeUNvb3JkaW5hdGUpIHtcbiAgICAgICAgICAgIHN0b25lLnkgKz0gU1RPTkVfU0laRTtcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGRlbGV0ZUZ1bGxSb3dzKCkge1xuICAgIGNvbnN0IHJvd3NUb0RlbGV0ZSA9IGdldEZpbmlzaGVkUm93cygpO1xuICAgIHJvd3NUb0RlbGV0ZS5zb3J0KCk7XG4gICAgcm93c1RvRGVsZXRlLmZvckVhY2goKHJvd1kpID0+IHtcbiAgICAgICAgcmVtb3ZlU3RvbmVzV2l0aFlDb29yZGluYXRlKHJvd1kpO1xuICAgIH0pXG4gICAgcm93c1RvRGVsZXRlLmZvckVhY2goKHJvd1kpID0+IHtcbiAgICAgICAgbW92ZVN0b25lc0Rvd253YXJkc1dpdGhZQ29vcmRpbmF0ZShyb3dZKVxuICAgIH0pXG4gICAgaWYgKHJvd3NUb0RlbGV0ZS5sZW5ndGgpIHtcbiAgICAgICAgaW5jcmVhc2VSb3dTY29yZShyb3dzVG9EZWxldGUubGVuZ3RoKVxuICAgIH1cbn1cblxuZnVuY3Rpb24gbW92ZVN0b25lTGVmdCgpIHtcbiAgICBpZiAoYWxsb3dNb3ZlTGVmdCgpKSB7XG4gICAgICAgIGRyb3BwaW5nU3RvbmUuc3F1YXJlcy5mb3JFYWNoKChzKSA9PiB7cy54IC09IFNUT05FX1NJWkV9KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG1vdmVTdG9uZVJpZ2h0KCkge1xuICAgIGlmKGFsbG93TW92ZVJpZ2h0KCkpIHtcbiAgICAgICAgZHJvcHBpbmdTdG9uZS5zcXVhcmVzLmZvckVhY2goKHMpID0+IHtzLnggKz0gU1RPTkVfU0laRX0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gaXNTdG9uZUJlbG93KCkge1xuICAgIHJldHVybiAgZHJvcHBpbmdTdG9uZS5zcXVhcmVzLmZpbmQoKHMpID0+IGlzUG9zaXRpb25UYWtlbihzLngsIHMueSArIFNUT05FX1NJWkUpKTtcbn1cblxuZnVuY3Rpb24gYWxsb3dNb3ZlTGVmdCgpIHtcbiAgICByZXR1cm4gICFkcm9wcGluZ1N0b25lLnNxdWFyZXMuZmluZCgocykgPT4gaXNQb3NpdGlvblRha2VuKHMueCAtIFNUT05FX1NJWkUsIHMueSkpO1xufVxuXG5mdW5jdGlvbiBhbGxvd01vdmVSaWdodCgpIHtcbiAgICByZXR1cm4gICFkcm9wcGluZ1N0b25lLnNxdWFyZXMuZmluZCgocykgPT4gaXNQb3NpdGlvblRha2VuKHMueCArIFNUT05FX1NJWkUsIHMueSkpO1xufVxuXG5mdW5jdGlvbiBpc1Bvc2l0aW9uVGFrZW4oeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICBsZXQgcG9zaXRpb25UYWtlbjogYm9vbGVhbiB8IFNxdWFyZSB8IHVuZGVmaW5lZCA9IGZhbHNlO1xuICAgIHBvc2l0aW9uVGFrZW4gPSB4IDwgMCB8fCB4ICsgU1RPTkVfU0laRSA+IENBTlZBU19XSURUSCB8fCB5ICsgU1RPTkVfU0laRSA+IENBTlZBU19IRUlHSFQ7IFxuICAgIHBvc2l0aW9uVGFrZW4gPSBwb3NpdGlvblRha2VuIHx8IHN0b25lcy5zcXVhcmVzLmZpbmQoKHMpID0+IHMueCA9PSB4ICYmIHMueSA9PSB5KTtcbiAgICByZXR1cm4gcG9zaXRpb25UYWtlblxufVxuXG5mdW5jdGlvbiBpc1N0b25lVG91Y2hpbmdCb3R0b20oKSB7XG4gICAgcmV0dXJuIGRyb3BwaW5nU3RvbmUuc3F1YXJlcy5maW5kKChzKSA9PiBzLnkgPj0gQ0FOVkFTX0hFSUdIVCAtIFNUT05FX1NJWkUpO1xufVxuXG5mdW5jdGlvbiBtb3ZlU3RvbmVEb3duKCkge1xuICAgIGRyb3BwaW5nU3RvbmUuc3F1YXJlcy5mb3JFYWNoKChzKSA9PiB7cy55ICs9IFNUT05FX1NJWkV9KTtcbn1cblxuZnVuY3Rpb24gbWFrZU5leHRTdGVwKCkge1xuICAgIGlmKCFpc1N0b25lVG91Y2hpbmdCb3R0b20oKSAmJiAhaXNTdG9uZUJlbG93KCkpIHtcbiAgICAgICAgbW92ZVN0b25lRG93bigpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgc3RvbmVzLnNxdWFyZXMucHVzaCguLi5kcm9wcGluZ1N0b25lLnNxdWFyZXMpO1xuICAgICAgICBkZWxldGVGdWxsUm93cygpXG4gICAgICAgIGNyZWF0ZU5ld1N0b25lKClcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYXdHYW1lKCkge1xuICAgIGlmKGNvbnRleHQpIHtcbiAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdG9uZXMuc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gbElORV9XSURUSDtcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnYmxhY2snO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBzdG9uZXMuc3F1YXJlc1tpXS5jb2xvcjtcbiAgICAgICAgICAgIGNvbnRleHQucmVjdChzdG9uZXMuc3F1YXJlc1tpXS54ICsgbElORV9XSURUSCAvIDIsIHN0b25lcy5zcXVhcmVzW2ldLnkgKyBsSU5FX1dJRFRIIC8gMiwgU1RPTkVfU0laRSwgU1RPTkVfU0laRSk7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGRyb3BwaW5nU3RvbmUuc3F1YXJlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gbElORV9XSURUSDtcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSAnYmxhY2snO1xuICAgICAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSBkcm9wcGluZ1N0b25lLnNxdWFyZXNbaV0uY29sb3I7XG4gICAgICAgICAgICBjb250ZXh0LnJlY3QoZHJvcHBpbmdTdG9uZS5zcXVhcmVzW2ldLnggKyBsSU5FX1dJRFRIIC8gMiwgZHJvcHBpbmdTdG9uZS5zcXVhcmVzW2ldLnkgKyBsSU5FX1dJRFRIIC8gMiwgU1RPTkVfU0laRSwgU1RPTkVfU0laRSk7XG4gICAgICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuZnVuY3Rpb24gc3RhcnRHYW1lTG9vcCgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHsgICAgXG4gICAgICAgIHJlRHJhd05lZWRlZCA9IHRydWU7XG4gICAgICAgIG1ha2VOZXh0U3RlcCgpO1xuICAgICAgICBpZighc3RvbmVzLnNxdWFyZXMuZmluZCgocykgPT4gcy55IDwgMCkpe1xuICAgICAgICAgICAgc3RhcnRHYW1lTG9vcCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbG9zdExhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xvc3RMYWJlbCcpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgaWYobG9zdExhYmVsKSB7XG4gICAgICAgICAgICAgICAgbG9zdExhYmVsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2FtZU92ZXIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSwgaW50ZXJmYWxsVGltZXIpXG4gICAgXG59XG5cbmZ1bmN0aW9uIHN0YXJ0RHJhd0dhbWVMb29wKCkge1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICBpZihyZURyYXdOZWVkZWQpIHtcbiAgICAgICAgICAgICAgICBkcmF3R2FtZSgpO1xuICAgICAgICAgICAgICAgIHJlRHJhd05lZWRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoIWdhbWVPdmVyKSB7XG4gICAgICAgICAgICAgICAgc3RhcnREcmF3R2FtZUxvb3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIClcbn1cbmNyZWF0ZU5ld1N0b25lKCk7XG5zdGFydEdhbWVMb29wKCk7XG5zdGFydERyYXdHYW1lTG9vcCgpO1xuXG5kb2N1bWVudC5vbmtleWRvd24gPSBjaGVja0tleTtcblxuZnVuY3Rpb24gY2hlY2tLZXkoZTogS2V5Ym9hcmRFdmVudCkge1xuXG5cbiAgICBpZiAoZS5rZXlDb2RlID09IDM4KSB7XG4gICAgICAgIHRyeVJvdGF0ZVN0b25lKCk7XG4gICAgICAgIHJlRHJhd05lZWRlZCA9IHRydWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKGUua2V5Q29kZSA9PSA0MCkge1xuICAgICAgICBtYWtlTmV4dFN0ZXAoKVxuICAgICAgICByZURyYXdOZWVkZWQgPSB0cnVlO1xuICAgIH1cbiAgICBlbHNlIGlmIChlLmtleUNvZGUgPT0gMzcpIHtcbiAgICAgICAgbW92ZVN0b25lTGVmdCgpO1xuICAgICAgICByZURyYXdOZWVkZWQgPSB0cnVlO1xuICAgIH1cbiAgICBlbHNlIGlmIChlLmtleUNvZGUgPT0gMzkpIHtcbiAgICAgICAgbW92ZVN0b25lUmlnaHQoKTtcbiAgICAgICAgcmVEcmF3TmVlZGVkID0gdHJ1ZTtcbiAgICB9XG5cbn1cbiJdLCJuYW1lcyI6WyJjb2xvciIsInNxdWFyZXMiLCJzcXVhcmVDb29yZGluYXRlIiwibWFwIiwiY29vcmRpbmF0ZSIsIngiLCJ5IiwidGhpcyIsInB1c2giLCJjYW52YXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsIlNUT05FX1NJWkUiLCJDQU5WQVNfSEVJR0hUIiwiQ0FOVkFTX1dJRFRIIiwiZ2FtZU92ZXIiLCJpbnRlcmZhbGxUaW1lciIsInN0b25lcyIsImRyb3BwaW5nU3RvbmUiLCJoZWlnaHQiLCJ3aWR0aCIsInJvd1Njb3JlIiwicmVEcmF3TmVlZGVkIiwiY3JlYXRlTmV3U3RvbmUiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJmb3JFYWNoIiwicyIsImlzUG9zaXRpb25UYWtlbiIsImZpbmQiLCJtYWtlTmV4dFN0ZXAiLCJjb2xsZWN0ZWRSb3dzIiwiZmluaXNoZWRSb3dzIiwicm93c1RvRGVsZXRlIiwic3RvbmUiLCJyb3ciLCJjb3VudCIsInNvcnQiLCJyb3dZIiwieUNvb3JkaW5hdGUiLCJmaWx0ZXIiLCJsZW5ndGgiLCJhZGRSb3dzQ291bnQiLCJyb3dTY29yZUxhYmVsIiwiaW5uZXJIVE1MIiwidG9TdHJpbmciLCJjb25zb2xlIiwibG9nIiwicG93IiwiaW50ZXJ2YWwiLCJyb3VuZCIsImluY3JlYXNlUm93U2NvcmUiLCJzdGFydEdhbWVMb29wIiwic2V0VGltZW91dCIsImxvc3RMYWJlbCIsInN0eWxlIiwiZGlzcGxheSIsInN0YXJ0RHJhd0dhbWVMb29wIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiY2xlYXJSZWN0IiwiaSIsImJlZ2luUGF0aCIsImxpbmVXaWR0aCIsInN0cm9rZVN0eWxlIiwiZmlsbFN0eWxlIiwicmVjdCIsImxJTkVfV0lEVEgiLCJmaWxsIiwic3Ryb2tlIiwiZHJhd0dhbWUiLCJvbmtleWRvd24iLCJlIiwia2V5Q29kZSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsInJlbGF0aXZlUG9zIiwibmV3UG9zaXRpb25zIiwiY2FsY3VsYXRlUm90YXRlZERyb3BwaW5nU3RvbmUiLCJ0YWtlblBvc2l0aW9uIiwibWluWCIsIm1pbiIsInBvc2l0aW9uIiwibWF4WCIsIm1heCIsIm1heFkiLCJjb3JyZWN0aW9uIiwic3VnZ2VzdFBvc2l0aW9uQ29ycmVjdGlvbiIsInRyeVJvdGF0ZVN0b25lIl0sInNvdXJjZVJvb3QiOiIifQ==